(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{283:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"前提："}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前提：","aria-hidden":"true"}},[s._v("#")]),s._v(" 前提：")]),s._v(" "),a("div",{staticClass:"tip custom-block"},[a("p",[s._v("本例使用的是Office 2016")])]),s._v(" "),a("h3",{attrs:{id:"添加ado-lib引用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加ado-lib引用","aria-hidden":"true"}},[s._v("#")]),s._v(" 添加ADO Lib引用")]),s._v(" "),a("ul",[a("li",[s._v("快捷键Alt+F11进入VBE Tools>References...>")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://xmhblog.s3-us-west-2.amazonaws.com/excel-crud-1.png",alt:"Excel-CRUD-Step1"}})]),s._v(" "),a("ul",[a("li",[s._v("勾选 Microsoft ActiveXData Object")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://xmhblog.s3-us-west-2.amazonaws.com/excel-crud-2.png",alt:"Excel-CRUD-Step2"}})]),s._v(" "),a("h2",{attrs:{id:"创建链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建链接","aria-hidden":"true"}},[s._v("#")]),s._v(" 创建链接")]),s._v(" "),a("div",{staticClass:"language-vbnet line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vbnet"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v(" Connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dbPath "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" ADODB.Connection\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" ADODB.Connection\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" objConn\n        .Provider "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Microsoft.ACE.OLEDB.12.0"')]),s._v("\n        .Properties"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Data Source"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dbPath\n        .Properties"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Persist Security Info"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("False")]),s._v("\n        ."),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Open")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" Connect "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" objConn\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Debug")]),s._v("."),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Print")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Connection established..."')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Function")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h2",{attrs:{id:"关闭链接"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭链接","aria-hidden":"true"}},[s._v("#")]),s._v(" 关闭链接")]),s._v(" "),a("div",{staticClass:"language-vbnet line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vbnet"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" CloseConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objConn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" ADODB.Connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("On Error")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Resume")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n    objConn."),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Close")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Debug")]),s._v("."),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Print")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Connection closed..."')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Nothing")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"增-删-改-查-基础程序"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#增-删-改-查-基础程序","aria-hidden":"true"}},[s._v("#")]),s._v(" 增/删/改/查 基础程序")]),s._v(" "),a("div",{staticClass:"language-vbnet line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vbnet"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Insert_Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strSQL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'示例strSQL = \"INSERT INTO TableName(Column_Name1, Columns_Name2) Values('Value1', 'Value12')\"")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'需要在使用的时候传入strSQL查询语句")]),s._v("\n    objCon.Execute strSQL\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Delete_Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strSQL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'示例strSQL = \"DELETE FROM TableName WHERE Column_Name1='Value1'\"")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'需要在使用的时候传入strSQL查询语句")]),s._v("\n    objCon.Execute strSQL\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Update_Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strSQL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("as")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'示例strSQL = \"UPDATE TableName SET Column_Name2= 'Value2' WHERE Column_Name1='Value1\"")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'需要在使用的时候传入strSQL查询语句")]),s._v("\n    objCon.Execute strSQL\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Read_Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strSQL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" shtName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" ADODB.Connection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('\'示例strSQL = "SELECT * FROM TableName"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" objRecordSet "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" ADODB.Recordset\n    objRecordSet."),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Open")]),s._v(" strSQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" objConn\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'输出字段名称和查询内容")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" ThisWorkbook.Sheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("shtName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        .UsedRange.ClearContents\n        .Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("."),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For Each")]),s._v(" objField "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("In")]),s._v(" objRecordSet.Fields\n            ActiveCell.Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" objField."),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Name")]),s._v("\n            ActiveCell.Offset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("."),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Select")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Next")]),s._v("\n        .Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".CopyFromRecordset objRecordSet\n        .Range"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"A1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".CurrentRegion.EntireColumn.AutoFit\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br")])]),a("h2",{attrs:{id:"进阶-使用commit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进阶-使用commit","aria-hidden":"true"}},[s._v("#")]),s._v(" 进阶, 使用commit")]),s._v(" "),a("p",[s._v("在操作数据库时，不想实时读写，遇到错误的时候需要回滚\n引用这段代码时，需要自己根据实际情况修改SQL相关字段名称和语句")]),s._v(" "),a("h3",{attrs:{id:"新增"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#新增","aria-hidden":"true"}},[s._v("#")]),s._v(" 新增")]),s._v(" "),a("div",{staticClass:"language-vbnet line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vbnet"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Main_Insert"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" ADODB.Connection\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" total_row "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" myPath "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'放在共享盘上，方便多人操作，权限需要通过共享盘来控制")]),s._v("\n    myPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(' "\\\\ant\\Database'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" & "')]),s._v('\\db.mdb"\n     \n    '),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" Sheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v('"新增"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n      total_row "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Rows.Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("."),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlUp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Row\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Excel一大特征就是灵活，代价是对数据格式控制的不好，即便设置了数据有效性，也会被用户轻易覆盖，本段代码用来检查key值是否为空，可以增加检查其他字段")]),s._v("\n        i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Do")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("While")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" total_row"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Null "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Or")]),s._v(" Trim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(".Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n                MsgBox "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v('"第一列Tracking Number有空值，请检查后再上传！  '),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" & i & "')]),s._v('行"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n            i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Loop")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("myPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("On Error")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" CleanFail\n        objConn.BeginTrans\n\n        i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Do")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("While")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" total_row"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("         \n\n            Tracking_Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Depart_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Scan_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            User_Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Report_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Filling_Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Uploader "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n\n            strSQL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Insert Into Expense (Tracking_Number,Depart_Date,Scan_Date,User_Name,Report_ID,Filling_Number,Uploader) "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Values(\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Tracking_Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\',"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                        IIf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Depart_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Null"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Depart_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('","')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                        IIf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Scan_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Null"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Scan_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('",\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                        User_Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"','\"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Report_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"','\"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Filling_Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"','\"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Uploader "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\')"')]),s._v("\n                \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" ADODB.Command\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" cmd.ActiveConnection "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" objConn\n            cmd.CommandType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" adCmdText\n            cmd.CommandText "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" strSQL\n            cmd.Execute\n\n            i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Loop")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'循环全部完成后统一提交")]),s._v("\n        objConn.CommitTrans\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n    \nCleanExit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Call")]),s._v(" CloseConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v('\n    MsgBox "数据上传成功！'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('", vbOKOnly, "')]),s._v('成功"\n    '),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n    \nCleanFail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v('\n    objConn.RollbackTrans\n    MsgBox "上传数据有误，本次未成功上传." '),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Err.Description\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Debug")]),s._v("."),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Print")]),s._v(" Err.Number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Err.Description\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Call")]),s._v(" CloseConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br")])]),a("h3",{attrs:{id:"删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除","aria-hidden":"true"}},[s._v("#")]),s._v(" 删除")]),s._v(" "),a("div",{staticClass:"language-vbnet line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vbnet"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Main_Delete"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" ADODB.Connection\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" total_row "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" myPath "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    \n    myPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(' "\\\\ant\\Database'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" & "')]),s._v('\\db.mdb"\n     \n    '),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" Sheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v('"删除"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        total_row "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Rows.Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("."),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlUp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Row\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Excel一大特征就是灵活，代价是对数据格式控制的不好，即便设置了数据有效性，也会被用户轻易覆盖，本段代码用来检查key值是否为空，可以增加检查其他字段")]),s._v("\n        i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Do")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("While")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" total_row"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Null "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Or")]),s._v(" Trim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(".Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n                MsgBox "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v('"第一列Parcel Tracking Number有空值，请检查后再上传！  '),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" & i & "')]),s._v('行"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n            i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Loop")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("myPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("On Error")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" CleanFail\n        objConn.BeginTrans\n    \n        i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Do")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("While")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v(" total_row "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'条件判定,运行到最后一行")]),s._v("\n            strSQL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"DELETE FROM Expense WHERE Tracking_Number=\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'"')]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" ADODB.Command\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" cmd.ActiveConnection "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" objConn\n            cmd.CommandType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" adCmdText\n            cmd.CommandText "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" strSQL\n            cmd.Execute\n            i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Loop")]),s._v("\n\n        objConn.CommitTrans\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n       \nCleanExit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Call")]),s._v(" CloseConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v('\n    MsgBox "数据删除成功！'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('", vbOKOnly, "')]),s._v('成功"\n    '),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\nCleanFail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v('\n    objConn.RollbackTrans\n    MsgBox "数据有误，本次未成功删除." '),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Err.Description\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Debug")]),s._v("."),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Print")]),s._v(" Err.Number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Err.Description\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Call")]),s._v(" CloseConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br")])]),a("h3",{attrs:{id:"更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新","aria-hidden":"true"}},[s._v("#")]),s._v(" 更新")]),s._v(" "),a("div",{staticClass:"language-vbnet line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vbnet"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Main_Update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" ADODB.Connection\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" myPath "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" strSQL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" shtName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" total_row "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Integer")]),s._v("\n    \n    myPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(' "\\\\ant\\Database'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" & "')]),s._v('\\db.mdb"\n\n    '),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v(" ThisWorkbook.Sheets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v('"更新"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        total_row "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Rows.Count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("."),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("xlUp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Row\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("'Excel一大特征就是灵活，代价是对数据格式控制的不好，即便设置了数据有效性，也会被用户轻易覆盖，本段代码用来检查key值是否为空，可以增加检查其他字段")]),s._v("\n        i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Do")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("While")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" total_row"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Null "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Or")]),s._v(" Trim"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(".Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Then")]),s._v("\n                MsgBox "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v('"第一列Parcel Tracking Number有空值，请检查后再上传！  '),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" & i & "')]),s._v('行"'),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v("\n            i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Loop")]),s._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("myPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("On Error")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("GoTo")]),s._v(" CleanFail\n        objConn.BeginTrans\n        \n        i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Do")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("While")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<=")]),s._v(" total_row"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("          \n           \n            Tracking_Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Depart_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Scan_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            User_Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Report_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Filling_Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            Uploader "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" .Cells"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Value\n            \n            strSQL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"UPDATE Expense SET Depart_Date="')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" IIf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Depart_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Null"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Depart_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('","')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                     "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Scan_Date="')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" IIf"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Scan_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Null"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Scan_Date "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\'"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('","')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                     "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"User_Name=\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" User_Name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\',"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                     "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Report_ID=\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Report_ID "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\',"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                     "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Filling_Number=\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Filling_Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\',"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                     "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Uploader=\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Uploader "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\' "')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" _\n                     "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"where Tracking_Number =\'"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Tracking_Number "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\' "')]),s._v("\n                       \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" cmd "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("New")]),s._v(" ADODB.Command\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" cmd.ActiveConnection "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" objConn\n            cmd.CommandType "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" adCmdText\n            cmd.CommandText "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" strSQL\n            cmd.Execute\n            \n            i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Loop")]),s._v("\n        objConn.CommitTrans\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("With")]),s._v("\n    \nCleanExit"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Call")]),s._v(" CloseConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v('\n    MsgBox "数据更新成功！'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('", vbOKOnly, "')]),s._v('成功"\n    '),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n        \nCleanFail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v('\n    objConn.RollbackTrans\n    MsgBox "更新有误！" '),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v(" Err.Description\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Debug")]),s._v("."),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Print")]),s._v(" Err.Number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Err.Description\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Call")]),s._v(" CloseConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Exit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n \n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br")])]),a("h3",{attrs:{id:"查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询","aria-hidden":"true"}},[s._v("#")]),s._v(" 查询")]),s._v(" "),a("p",[s._v("引用了基础模块里的Read_Data")]),s._v(" "),a("div",{staticClass:"language-vbnet line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-vbnet"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v(" Main_Read"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" ADODB.Connection\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" myPath "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" strSQL "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Dim")]),s._v(" shtName "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("As")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("String")]),s._v("\n    \n    myPath "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(' "\\\\ant\\Database'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('" & "')]),s._v('\\db.mdb"\n    '),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Set")]),s._v(" objConn "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Connect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("myPath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    strSQL "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Select * from Expense"')]),s._v("\n    shtName "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(' "查询"\n    '),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Call")]),s._v(" Read_Data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("strSQL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" shtName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" objConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Call")]),s._v(" CloseConnection"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("objConn"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("End")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Sub")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])])])},[],!1,null,null,null);t.default=e.exports}}]);